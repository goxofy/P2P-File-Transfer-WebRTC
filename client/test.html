<!DOCTYPE html>
<html>
<head>
    <title>DataChannel Test</title>
</head>
<body>
    <h1>DataChannel Communication Test</h1>
    <button id="test-send">Send Test Message</button>
    <div id="log"></div>
    
    <script src="webrtc-manager.js"></script>
    <script>
        const log = document.getElementById('log');
        
        function addLog(message) {
            const div = document.createElement('div');
            div.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            log.appendChild(div);
        }
        
        const manager = new WebRTCManager();
        
        manager.onDataChannelOpen = () => {
            addLog('DataChannel opened - ready to send messages');
        };
        
        manager.onDataChannelMessage = (data) => {
            addLog(`Received: ${data}`);
        };
        
        document.getElementById('test-send').addEventListener('click', () => {
            const testMessage = `Test message at ${Date.now()}`;
            addLog(`Sending: ${testMessage}`);
            const success = manager.sendData(testMessage);
            addLog(`Send result: ${success}`);
        });
        
        // Auto-connect for testing
        manager.connectToSignalingServer().then(() => {
            manager.joinRoom('test-room');
        });
    </script>
</body>
</html>